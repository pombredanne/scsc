<VirtualHost *:443>
  ServerName <%= @params[:server_name] %>

  SSLEngine On
  SSLCertificateFile /etc/openvpn/server.crt
  SSLCertificateKeyFile /etc/openvpn/server.key

  ProxyPreserveHost On
  ProxyPass / <%= @params[:dest] %>
  ProxyPassReverse / <%= @params[:dest] %>
  <Proxy>
    Order deny,allow
    Allow from 10.17.0
  </Proxy>


  LogLevel info
  ErrorLog <%= node['apache']['log_dir'] %>/<%= @params[:name] %>-error.log
  CustomLog <%= node['apache']['log_dir'] %>/<%= @params[:name] %>-access.log combined
</VirtualHost>
